<style>
	
	.sr-graphic h1 {
		font-family: 'Roboto',san-serif;
		font-size: 3.0em;
		font-weight:700;
		color:#4DC193;
		margin:0;
		padding:0;
	}

	.sr-graphic h2 {
		font-family: 'Roboto',san-serif;
		font-size: 1.5em;
		text-transform: uppercase;
		color:#57504E;
		margin:0;
		padding:0;
	}

	.sr-graphic p {
		margin:0 0 1em 0;
		padding:0;
		line-height: 1.4em;
		font-family:'Roboto', san-serif;
		font-weight:300;
		color:#97918F;
		font-size:.9em;
	}

	.sr-graphic a {
		color: #4DC193;
		text-decoration: none;
		font-weight:700;
	}

	.sr-graphic a:hover {
		text-decoration:underline;
	}

	.sr-graphic #content {

		margin: 0 auto;
	}

	.sr-graphic #categories {
		font-family: Arial,sans-serif;
		margin:20px 0;
	}

	.sr-graphic #categories a {
		color: #000;
		font-size: 12px;
		padding: 5px;
		background: #e2e2e2;
		cursor: pointer;
		margin-right: 3px;
	}

	.sr-graphic #categories a {
		text-decoration:none;
	}

	.sr-graphic #categories a:last-child {
		margin-right: 0;
	}

	.sr-graphic #categories a.cat1 {
		background: #895881;
		color: #fff;
	}

	.sr-graphic #categories a.cat2 {
		background: #ED7C31;
		color: #fff;
	}

	.sr-graphic #categories a.cat3 {
		background: #82A5C0;
		color: #fff;
	}

	.sr-graphic #categories a.cat4 {
		background: #6E9E75;
		color: #fff;
	}

	.sr-graphic #categories a.cat5 {
		background: #00BBD6;
		color: #fff;
	}

	.sr-graphic #chart {
		min-height: 550px;
		margin: 0 auto;
	}

	.sr-graphic #info {
		height: 60px;
		border-top: 1px solid #e2e2e2;
		padding: 20px 0 0 0;
	}

	.sr-graphic path {
		stroke: #e2e2e2;
		stroke-width: 2;
		fill: none;
		cursor:pointer;
	}

	.sr-graphic path.current, .sr-graphic path.highlight.current {
		stroke: #57504E;
		stroke-width: 1.7;
	}

	.cat1 {
		stroke: #368d6a !important;
	}

	.cat2 {
		stroke: #3d9f78 !important;
	}

	.cat3 {
		stroke: #44b286 !important;
	}

	.cat4 {
		stroke: #52bd92 !important;
	}

	.cat5 {
		stroke: #64c49e !important;
	}
	.cat6 {
		stroke: #77cba9 !important;
	}
	.cat7 {
		stroke: #89d2b5 !important;
	}

	.cat8 {
		stroke: #89d2b5 !important;
	}

	.highlight {
		stroke-width: 1px;
	}

	.sr-graphic line {
		stroke: #000;
	}

	.sr-graphic text {
		font-family: Helvetica,Arial,sans-serif;
		font-size: 11px;
	}

	.axis {
		stroke-width: 0.8;
		stroke: #000;
	}

	.xTicks,.yTicks {
		stroke-width: 0.6;
		stroke: #000;
	}

	.sr-graphic #source {
		font-size: 0.8em;
		text-align: right;
		margin-top: 10px;
		padding-bottom: 20px;
		font-weight:300;
	}




</style>
<body>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://www.edsource.org/wp-content/js/underscore-min.js"></script>
	

	
	<script>
	/* CODE TO DRAW D3.JS PATHS ADAPTED FROM NATHAN YAU'S LIFE EXPECTANCY CHART http://projects.flowingdata.com/life-expectancy/ */

	//Globals//
	var	w = 1300,h = 700, margin = 30,startYear = 2005,endYear = 2012,startReports = 0,endReports = 60,
		y = d3.scale.linear().domain([endReports, startReports]).range([0 + margin, h - margin]),
		x = d3.scale.linear().domain([2005, 2011]).range([0 + margin - 5, w-10]),
		years = d3.range(startYear, endYear);
	var chart = d3.select("body").append("svg:svg").attr("width", w).attr("height", h).append("svg:g")
	var line = d3.svg.line().x(function(d, i) {
		return x(d.x);
	}).y(function(d) {
		return y(d.y);
	});
	var selpaFilter = [];
	var startEnd = {}

	//Grab SELPA population//
	d3.text('data-3.csv', 'text/csv', function(text) {
		var selpaPop = d3.csv.parseRows(text);
		for (i = 1; i < selpaPop.length; i++) {
			selpaFilter[i] = selpaPop[i][1];
		}
	});

	//Populate Lines and Data//
	d3.text('data-2.csv', 'text/csv', function(text) {
		var selpaData = d3.csv.parseRows(text);
		for (i = 1; i < selpaData.length; i++) {
			var values = selpaData[i].slice(2, selpaData[i.length - 1]);
			console.log(values)
			var currData = [];
			var started = false;
			for (j = 0; j < values.length; j++) {
				if (values[j] != '') {
					currData.push({
						x: years[j],
						y: values[j]
					});
					if (!started) {
						startEnd[selpaData[i][0]] = {
							'startYear': years[j],
							'startVal': values[j]
						};
						started = true;
					} else if (j == values.length - 1) {
						startEnd[selpaData[i][0]]['endYear'] = years[j];
						startEnd[selpaData[i][0]]['endVal'] = values[j];
					}
				}
			}
			chart.append("svg:path").data([currData]).attr("selpa", selpaData[i][0]).attr("class", "cat" + selpaFilter[i]).attr("d", line).on("mouseover", onmouseover).on("mouseout", onmouseout);
		}	
	});

	//Draw Axes//
	chart.append("svg:line").attr("x1", x(2005)).attr("y1", 670).attr("x2", x(2011)).attr("y2", 670).attr("class", "axis");
	chart.append("svg:line").attr("x1", x(startYear)).attr("y1", y(startReports)).attr("x2", x(startYear)).attr("y2", y(endReports)).attr("class", "axis");

	//Move Axes to Top//
	$("svg line:eq(0)").add("svg line:eq(1)").detach().insertAfter("#chart svg g");


	//Populate Labels and Ticks
	chart.selectAll(".xLabel").data(x.ticks(5)).enter().append("svg:text").attr("class", "xLabel").text(String).attr("x", function(d) {
		return x(d)
	}).attr("y", h - 10).attr("text-anchor", "middle");

	chart.selectAll(".yLabel").data(y.ticks(4)).enter().append("svg:text").attr("class", "yLabel").text(String).attr("x", 0).attr("y", function(d) {
		return y(d)
	}).attr("text-anchor", "right").attr("dy", 3);

	chart.selectAll(".xTicks").data(x.ticks(5)).enter().append("svg:line").attr("class", "xTicks").attr("x1", function(d) {
		return x(d);
	}).attr("y1", y(startReports)).attr("x2", function(d) {
		return x(d);
	}).attr("y2", y(startReports) + 7);

	chart.selectAll(".yTicks").data(y.ticks(4)).enter().append("svg:line").attr("class", "yTicks").attr("y1", function(d) {
		return y(d);
	}).attr("x1", x(2004.95)).attr("y2", function(d) {
		return y(d);
	}).attr("x2", x(2005));

	function onclick(d, i) {
		var currClass = d3.select(this).attr("class");
		if (d3.select(this).classed('selected')) {
			d3.select(this).attr("class", currClass.substring(0, currClass.length - 9));
		} else {
			d3.select(this).classed('selected', true);
		}
	}

	function onmouseover(d, i) {
		var currClass = d3.select(this).attr("class");
		var reorder = $(this);
		reorder.detach().insertAfter("svg path:last");
		d3.select(this).attr("class", currClass + " current");
		var selpaLabel = $(this).attr("selpa");
		var selpaValues = startEnd[selpaLabel];
		var info = '<h2>' + selpaLabel + '</h2>';
		info += "<p>This SELPA had <strong>" + Math.round(selpaValues['startVal']*100)/100 + "</strong> emergency behavior reports per 100 students in " + selpaValues['startYear'] + " and <strong>" + Math.round(selpaValues['endVal']*100)/100 + "</strong> in " + selpaValues['endYear'] + ".</p>";
		$("#default-info").hide();
		$("#info-content").html(info);
	}

	function onmouseout(d, i) {
		var currClass = d3.select(this).attr("class");
		var prevClass = currClass.substring(0, currClass.length - 8);
		d3.select(this).attr("class", prevClass);
		$("#default-info").show();
		$("#info-content").html('');
	}

	function showCategory(category) {
		var selpaCat = d3.selectAll("path." + category);
		if (selpaCat.classed('highlight')) {
			selpaCat.attr("class", category);
		} else {
			selpaCat.classed('highlight', true);
		}
		$(".cat1").detach().insertAfter("svg path:last");
	}

	$(document).ready(function() {
	    $('#categories a').click(function() {
	        $(".cat1").detach().insertAfter("svg path:last");
			$(".cat2").detach().insertAfter("svg path:last");
			$(".cat3").detach().insertAfter("svg path:last");
			$(".cat4").detach().insertAfter("svg path:last");
			$(".cat5").detach().insertAfter("svg path:last");
			$(".cat6").detach().insertAfter("svg path:last");
			$(".cat7").detach().insertAfter("svg path:last");
			$(".cat8").detach().insertAfter("svg path:last");
	    });
	});
	
		
	</script>
</body>
